# Timeline - Environment Configuration Template
# Copy this file to .env and fill in your values
# NEVER commit .env to version control!

# ============================================================================
# Application
# ============================================================================
APP_NAME=Timeline
APP_VERSION=1.0.0
APP_ENV=development  # development, staging, production
DEBUG=true

# ============================================================================
# Server
# ============================================================================
HOST=0.0.0.0
PORT=8000

# ============================================================================
# Database (PostgreSQL)
# ============================================================================
DATABASE_URL=postgresql+asyncpg://timeline_user:timeline_password@localhost:5432/timeline_db
DATABASE_ECHO=false  # Set to true to see SQL queries in logs
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20

# For synchronous operations (if needed)
DATABASE_URL_SYNC=postgresql://timeline_user:timeline_password@localhost:5432/timeline_db

# ============================================================================
# Redis (Caching)
# ============================================================================
REDIS_URL=redis://localhost:6379/0
REDIS_TTL=3600  # Cache TTL in seconds

# ============================================================================
# Security
# ============================================================================
# Generate with: openssl rand -hex 32
SECRET_KEY=your-super-secret-key-change-this-in-production-use-openssl-rand-hex-32
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# Password hashing
BCRYPT_ROUNDS=12

# ============================================================================
# CORS
# ============================================================================
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000
ALLOWED_METHODS=*
ALLOWED_HEADERS=*
ALLOW_CREDENTIALS=true

# ============================================================================
# Multi-Tenancy
# ============================================================================
TENANT_HEADER_NAME=X-Tenant-ID
ENABLE_SUBDOMAIN_ROUTING=false  # Set to true for subdomain-based tenant routing
DOMAIN=timeline.local  # For subdomain routing: tenant1.timeline.local

# ============================================================================
# Object Storage (S3-compatible)
# ============================================================================
# AWS S3
# .env file
STORAGE_BACKEND=local  # or "s3"
# For local development, use a directory in the project
STORAGE_ROOT=./storage  # or use absolute path like /Users/yourusername/dev/timeline/storage

# For S3:
S3_BUCKET=timeline-docs
S3_REGION=us-east-1
S3_ENDPOINT_URL=http://localhost:9000  # For MinIO

# MinIO (local development)
# S3_ENDPOINT_URL=http://localhost:9000
# AWS_ACCESS_KEY_ID=minioadmin
# AWS_SECRET_ACCESS_KEY=minioadmin

# Azure Blob Storage (alternative)
# AZURE_STORAGE_ACCOUNT_NAME=your-account-name
# AZURE_STORAGE_ACCOUNT_KEY=your-account-key
# AZURE_CONTAINER_NAME=timeline-documents

# ============================================================================
# Email (SMTP) - For outgoing notifications
# ============================================================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=notifications@yourcompany.com
SMTP_PASSWORD=your-smtp-password
SMTP_FROM_EMAIL=noreply@yourcompany.com
SMTP_FROM_NAME=Timeline System
SMTP_USE_TLS=true

# ============================================================================
# Gmail OAuth 2.0 Integration - For email sync
# ============================================================================
# See docs/GMAIL_OAUTH_SETUP.md for detailed setup instructions
#
# 1. Create project at https://console.cloud.google.com/
# 2. Enable Gmail API
# 3. Configure OAuth consent screen
# 4. Create OAuth 2.0 credentials (Web application)
# 5. Add redirect URI: http://localhost:8000/auth/gmail/callback
# 6. Copy Client ID and Client Secret below
#
GMAIL_CLIENT_ID=your-client-id.apps.googleusercontent.com
GMAIL_CLIENT_SECRET=GOCSPX-your-client-secret
GMAIL_REDIRECT_URI=http://localhost:8000/auth/gmail/callback
GMAIL_SCOPES=https://www.googleapis.com/auth/gmail.readonly,https://www.googleapis.com/auth/gmail.modify

# ============================================================================
# Outlook OAuth 2.0 Integration (Optional)
# ============================================================================
# See Microsoft Azure Portal for setup: https://portal.azure.com/
#
# OUTLOOK_CLIENT_ID=your-azure-application-id
# OUTLOOK_CLIENT_SECRET=your-azure-client-secret
# OUTLOOK_REDIRECT_URI=http://localhost:8000/auth/outlook/callback
# OUTLOOK_TENANT_ID=common  # or your-tenant-id for organization-specific
# OUTLOOK_SCOPES=https://graph.microsoft.com/Mail.Read,https://graph.microsoft.com/Mail.ReadWrite

# ============================================================================
# Background Jobs (Celery - if used)
# ============================================================================
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# ============================================================================
# Logging
# ============================================================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json, text
LOG_FILE=logs/timeline.log
LOG_MAX_BYTES=10485760  # 10MB
LOG_BACKUP_COUNT=5

# ============================================================================
# Monitoring & Observability
# ============================================================================
# Sentry (Error Tracking)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# Datadog (APM)
DD_AGENT_HOST=localhost
DD_TRACE_ENABLED=false
DD_SERVICE=timeline-api
DD_ENV=development

# ============================================================================
# Rate Limiting
# ============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_PER_HOUR=1000

# ============================================================================
# Feature Flags
# ============================================================================
ENABLE_CHAIN_VERIFICATION=true
ENABLE_WORKFLOW_AUTOMATION=true
ENABLE_SCHEMA_REGISTRY=true
ENABLE_DOCUMENT_OCR=false

# ============================================================================
# Testing
# ============================================================================
# Test database (separate from development)
TEST_DATABASE_URL=postgresql+asyncpg://timeline_test:timeline_test@localhost:5432/timeline_test_db

# ============================================================================
# Development Tools
# ============================================================================
# Auto-reload on code changes
RELOAD=true

# API documentation
DOCS_URL=/docs
REDOC_URL=/redoc
OPENAPI_URL=/openapi.json

# ============================================================================
# Production Settings (DO NOT USE IN DEVELOPMENT)
# ============================================================================
# Uncomment and configure for production deployment

# SSL/TLS
# SSL_KEYFILE=/path/to/keyfile.pem
# SSL_CERTFILE=/path/to/certfile.pem

# Workers (Gunicorn/Uvicorn)
# WORKERS=4
# WORKER_CLASS=uvicorn.workers.UvicornWorker
# WORKER_TIMEOUT=120

# Proxy headers (if behind load balancer)
# FORWARDED_ALLOW_IPS=*
# PROXY_HEADERS=true

# ============================================================================
# Docker Compose Overrides
# ============================================================================
# These are used by docker-compose.yml

# PostgreSQL
POSTGRES_USER=timeline_user
POSTGRES_PASSWORD=timeline_password
POSTGRES_DB=timeline_db
POSTGRES_PORT=5432

# Redis
REDIS_PORT=6379

# MinIO (S3-compatible)
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001

# ============================================================================
# Notes
# ============================================================================
# 1. Copy this file to .env and fill in your values
# 2. NEVER commit .env to version control
# 3. Generate secure SECRET_KEY: openssl rand -hex 32
# 4. Use different credentials for each environment
# 5. In production, use proper secret management (AWS Secrets Manager, etc.)
